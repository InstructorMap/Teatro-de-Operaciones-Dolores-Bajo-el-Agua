<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flyer Oficial - Teatro de Operaciones DBA2026</title>
    
    <meta property="og:title" content="üö® TEATRO DE OPERACIONES DBA2026">
    <meta property="og:description" content="Entrenamiento Hidro-T√°ctico de Alto Rendimiento. 27-28 FEB. Cupos Limitados. Toca para ingresar.">
    <meta property="og:image" content="https://teatro-de-operaciones-dolores-bajo.vercel.app/preview-flyer.jpg"> 
    <meta property="og:image:width" content="1080">
    <meta property="og:image:height" content="1920">
    <meta property="og:url" content="https://teatro-de-operaciones-dolores-bajo.vercel.app/flyer.html">
    <meta property="og:type" content="website">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Exo+2:wght@300;600;800;900&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root { 
            --bg-deep: #020405; 
            --hydro-cyan: #00e5ff; 
            --rescue-orange: #ff4500; 
        }
        body { background-color: #111; font-family: 'Exo 2', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }

        /* CONTENEDOR PRINCIPAL (9:16 - Formato Historia/Celular) */
        #flyer-container {
            width: 450px; 
            height: 800px;
            background: #020405;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 60px rgba(0, 229, 255, 0.15);
            border: 1px solid #333;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* FONDO */
        .flyer-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('inundacion2.jpg'); 
            background-size: cover; background-position: center;
            opacity: 0.3; 
            filter: grayscale(100%) contrast(120%);
            z-index: 1;
        }
        
        /* HEADER (AVALES) */
        .f-header-strip {
            position: relative; z-index: 20;
            background: rgba(5, 8, 10, 0.96); 
            width: 100%;
            min-height: 100px; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-bottom: 2px solid var(--hydro-cyan);
            padding: 10px;
        }

        /* FOOTER (SPONSORS) */
        .f-footer-strip {
            position: relative; z-index: 20;
            background: rgba(5, 8, 10, 0.96); 
            width: 100%;
            min-height: 110px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-top: 2px solid var(--rescue-orange);
            padding: 10px;
        }

        /* CUERPO CENTRAL */
        .f-body {
            position: relative; z-index: 10;
            flex-grow: 1; 
            display: flex;
            flex-direction: column;
            justify-content: center; 
            align-items: center;
            padding: 10px 20px;
            text-align: center;
            gap: 25px; /* Espacio limpio entre elementos */
        }

        /* T√çTULOS */
        .f-title-main { 
            font-family: 'Black Ops One'; 
            font-size: 3rem;
            color: white; 
            line-height: 1; 
            text-shadow: 0 5px 25px rgba(0,0,0,0.9); 
            margin: 0;
            text-transform: uppercase;
        }
        .f-title-sub { 
            font-family: 'Black Ops One';
            color: var(--rescue-orange); 
            font-size: 2.2rem;
            line-height: 1.1; 
            text-transform: uppercase;
            margin-top: 5px;
            margin-bottom: 5px; 
        }
        .f-subtitle-badge { 
            color: var(--hydro-cyan); 
            font-size: 0.9rem; 
            letter-spacing: 3px; 
            font-weight: 800; 
            text-transform: uppercase; 
            background: rgba(0, 229, 255, 0.1);
            border: 1px solid var(--hydro-cyan);
            padding: 5px 15px;
            border-radius: 4px;
            display: inline-block;
            margin-top: 15px; 
        }

        /* FECHA */
        .f-date-box { 
            background: rgba(0,0,0,0.85); 
            border-left: 5px solid var(--rescue-orange); 
            padding: 10px 25px; 
            backdrop-filter: blur(5px);
            box-shadow: 0 0 25px rgba(0,0,0,0.6);
            transform: skew(-5deg);
        }
        .f-date-content { transform: skew(5deg); }
        .f-date { font-size: 2.2rem; font-weight: 900; color: white; line-height: 1; }
        .f-loc { color: #ccc; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; margin-top: 5px; font-weight: 700; }

        /* === NUEVO ELEMENTO: BOT√ìN T√ÅCTICO (Reemplaza al QR) === */
        .f-action-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            text-decoration: none; 
            transition: transform 0.2s;
        }
        /* Efecto Zoom al pasar el mouse (solo web) */
        .f-action-wrapper:hover { transform: scale(1.05); }

        .f-icon-circle {
            width: 130px; height: 130px;
            border: 3px solid rgba(255,255,255,0.8);
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            box-shadow: 0 0 50px rgba(0, 229, 255, 0.3), inset 0 0 30px rgba(0, 229, 255, 0.2);
            background: rgba(0,0,0,0.6);
            margin-bottom: 15px;
            position: relative;
        }
        
        /* Animaci√≥n de Radar (Giro lento) */
        .f-icon-circle::after {
            content: ''; position: absolute; top: -5px; left: -5px; right: -5px; bottom: -5px;
            border-radius: 50%;
            border-top: 4px solid var(--hydro-cyan);
            border-right: 4px solid transparent;
            border-bottom: 4px solid var(--hydro-cyan);
            border-left: 4px solid transparent;
            animation: spinTarget 6s linear infinite;
        }

        .f-big-icon {
            font-size: 4rem; color: white;
            text-shadow: 0 0 20px var(--hydro-cyan);
        }

        .f-cta-btn {
            background: linear-gradient(135deg, var(--rescue-orange), #d50000);
            color: white;
            font-family: 'Exo 2';
            font-weight: 900;
            padding: 12px 35px;
            font-size: 1.1rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            /* Forma recortada t√°ctica */
            clip-path: polygon(15px 0, 100% 0, 100% calc(100% - 15px), calc(100% - 15px) 100%, 0 100%, 0 15px);
            box-shadow: 0 0 30px rgba(255, 69, 0, 0.4);
            border: 1px solid rgba(255,255,255,0.2);
        }

        @keyframes spinTarget { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* LOGOS */
        .strip-title { 
            font-size: 0.6rem; color: #888; font-weight: 900; 
            text-transform: uppercase; letter-spacing: 2px; margin-bottom: 8px; 
        }
        .logos-row { display: flex; gap: 15px; justify-content: center; align-items: center; width: 100%; flex-wrap: wrap; }
        
        .logo-img { 
            height: 45px; object-fit: contain; 
            background: rgba(255, 255, 255, 0.08); 
            border-radius: 4px; padding: 5px;
        } 
        .logo-aval { height: 55px; background: rgba(255, 255, 255, 0.12); }

    </style>
</head>
<body>

    <div style="position:fixed; top:20px; right:20px; z-index:100;">
        <button onclick="downloadFlyer()" class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-full font-bold shadow-xl transition-all flex items-center gap-2 border-2 border-blue-400">
            <i class="fas fa-camera"></i> DESCARGAR FLYER
        </button>
    </div>

    <div id="flyer-container">
        <div class="flyer-bg" id="dynamic-bg-layer"></div>
        
        <div class="f-header-strip">
            <span class="strip-title">ORGANIZA & AVALA</span>
            <div class="logos-row" id="avales-container"></div>
        </div>

        <div class="f-body">
            
            <div>
                <div class="f-title-main">TEATRO DE <br>OPERACIONES</div>
                <div class="f-title-sub">DBA 2026</div>
                <div class="f-subtitle-badge">HIDRO-T√ÅCTICO</div>
            </div>

            <div class="f-date-box">
                <div class="f-date-content">
                    <div class="f-date">27-28 FEB</div>
                    <div class="f-loc"><i class="fas fa-map-marker-alt text-cyan-400"></i> DOLORES, BS. AS.</div>
                </div>
            </div>

            <a href="https://teatro-de-operaciones-dolores-bajo.vercel.app/" class="f-action-wrapper">
                <div class="f-icon-circle">
                    <i class="fas fa-crosshairs f-big-icon"></i>
                </div>
                <div class="f-cta-btn">INGRESAR</div>
            </a>
            
        </div>

        <div class="f-footer-strip">
            <span class="strip-title">NOS ACOMPA√ëAN</span>
            <div class="logos-row" id="sponsors-container"></div>
        </div>
    </div>

    <script>
        // CONFIGURACI√ìN SUPABASE
        const SB_URL = 'https://bqhitoqdfzjzqfcltgap.supabase.co';
        const SB_KEY = 'sb_publishable__uctuloHzMPp2GK5KPKgjQ_7LGlZ9E6';
        const sb = supabase.createClient(SB_URL, SB_KEY);

        document.addEventListener('DOMContentLoaded', () => {
            loadData();
        });

        // CARGA DE DATOS DESDE LA NUBE
        async function loadData() {
            try {
                let { data, error } = await sb.from('sitio_config').select('datos').eq('id', 1).single();
                if (data && data.datos) {
                    const DB = data.datos;
                    // Fondo
                    if(DB.config.bg) document.getElementById('dynamic-bg-layer').style.backgroundImage = `url('${DB.config.bg}')`;
                    
                    // Logos
                    renderLogos('avales-container', DB.avales, 'logo-aval');
                    renderLogos('sponsors-container', DB.sponsors, 'logo-img');
                }
            } catch (err) { console.error(err); }
        }

        // RENDERIZADO DE LOGOS
        function renderLogos(containerId, list, extraClass) {
            const div = document.getElementById(containerId);
            if(list && list.length > 0) {
                div.innerHTML = list.map(item => `<img src="${item.img}" class="${extraClass}" crossorigin="anonymous">`).join('');
            } else {
                div.innerHTML = '<span style="color:#555; font-size:0.6rem; letter-spacing:2px;">ESPACIO DISPONIBLE</span>';
            }
        }

        // FUNCI√ìN DE DESCARGA (GENERADOR DE IMAGEN)
        function downloadFlyer() {
            const btn = event.target.closest('button');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> GENERANDO...';
            btn.disabled = true;

            const node = document.getElementById('flyer-container');
            
            // Pausa de 500ms para asegurar que todo est√© renderizado
            setTimeout(() => {
                html2canvas(node, {
                    scale: 3, 
                    useCORS: true, 
                    allowTaint: true,
                    backgroundColor: '#020405',
                    logging: false
                }).then(canvas => {
                    const link = document.createElement('a');
                    link.download = 'Flyer_TeatroOperaciones_2026.jpg'; // Nombre del archivo
                    link.href = canvas.toDataURL("image/jpeg", 0.95);
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);

                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }).catch(err => {
                    console.error("Error descarga:", err);
                    btn.innerHTML = 'ERROR AL GENERAR';
                    btn.disabled = false;
                });
            }, 500); 
        }
    </script>
</body>
</html>
